<!doctype html>
<html>

<head>
  <title>GadgetBridge Desktop</title>
</head>

<body>
  <link rel="stylesheet" href="index.css">
  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
  <script>
    var currentNumber = '4795304039';
    $(function () {
      var socket = io('http://localhost:3000');
      // $('form').submit(function () {
      //   socket.emit('new sms', $('#m').val());
      //   $('#m').val('');
      //   return false;
      // });
      socket.on('new sms', function (message) {
        addContact(message);
        if ($.trim(message.number) === currentNumber) {
          addSMS(message);
        }
        // window.scrollTo(0, document.body.scrollHeight);

      });
      function addSMS(message) {
        const className = message.type === 'inbox' ? 'replies' : 'sent';
        $(".messages ul").append(`
          <li class="`+ className + `">
            <img src="http://emilcarlsson.se/assets/harveyspecter.png" alt="" />
            <p>`+ message.body + `</p>
          </li>
        `);
      }

      function addContact(message) {
        var id = 'contact_' + message.number;
        if ($('#'+id).length === 0 ) {
          $("#contacts ul").append(`
            <li class="contact" id="`+ id + `" onClick="setCurrentNumber(`+ message.number+`)">
              <div class="wrap">
                <img src="http://emilcarlsson.se/assets/louislitt.png" alt="" />
                <div class="meta">
                  <p class="name">`+ message.name + `</p>
                  <p class="preview">`+ message.number + `</p>
                </div>
              </div>
            </li>
          `);
        }
        // setTimeout(() => {

        // }, 100);

      }
      function addMessage(message) {

      }
    });
  </script>
  <div id="frame">
    <div id="sidepanel">
      <div id="contacts">
        <ul>
          
        </ul>
      </div>
      <div id="bottom-bar">
        <button id="addcontact"><i class="fa fa-user-plus fa-fw" aria-hidden="true"></i> <span>Add contact</span></button>
        <button id="settings"><i class="fa fa-cog fa-fw" aria-hidden="true"></i> <span>Settings</span></button>
      </div>
    </div>
    <div class="content">
      <div class="message-input">
        <div class="wrap">
          <input type="text" placeholder="Write your message..." />
          <i class="fa fa-paperclip attachment" aria-hidden="true"></i>
          <button class="submit"><i class="fa fa-paper-plane" aria-hidden="true"></i></button>
        </div>
      </div>
      <div class="messages">
        <ul>
          
        </ul>
      </div>
    </div>
  </div>
</body>

</html>